YUI.add("autosuggest-tictac-stats",function(t){"use strict";function e(e,n){var o=this;if(!n||!t.Lang.isFunction(n.stat))throw new Error("Invalid Tictac Base Stat object provided");if(!(e&&e instanceof YUI))throw new Error("YUI instance not provided for stats");o.StatObj=n,o.statHandlers=[e.on("autosuggest:select",t.bind(o._onSelection,o)),e.on("autosuggest:serverdata",t.bind(o._onServerDataReceived,o)),e.on("autosuggest:cachecheck",t.bind(o._onCacheCheck,o)),e.on("autosuggest:error",t.bind(o._onError,o)),e.on("autosuggest:socialfooterclick",t.bind(o._onSocialFooterClick,o)),e.on("autosuggest:socialfooterhide",t.bind(o._onSocialHideClick,o)),e.on("autosuggest:socialfootershow",t.bind(o._onSocialFooterShow,o)),e.on("autosuggest:hideendpoint",t.bind(o._onHideEndpoint,o)),e.on("autosuggest:unhideendpoint",t.bind(o._onUnhideEndpoint,o)),e.on("autosuggest:hiderelatedcontacts",t.bind(o._onHideRelatedContacts,o)),e.on("autosuggest:searchperformance",t.bind(o._onPerformanceRequest,o)),e.on("autosuggest:searchretries",t.bind(o._onRetriesFinished,o)),e.on("autosuggest:prefetchdata",t.bind(o._onPrefetchDataReceived,o)),e.on("autosuggest:staticfootershow",t.bind(o._onStaticFooterShow,o)),e.on("autosuggest:staticfooterclick",t.bind(o._onStaticFooterClick,o))]}function n(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)&&t>=0}var o=e.prototype;o._isValidTimeStat=function(t,e){return n(t)&&t>0&&("s"===e&&t<1e3||"ms"===e&&t<1e6)},o._onSelection=function(t){if(t){t.inputMethod||(t.inputMethod="invalid_value");var e=this;t.searchText=t.searchText||"",n(t.selectionIndex)&&e.StatObj.stat("selection",{index:t.selectionIndex,inputLength:t.searchText.length,source:t.resultSource}),e._isValidTimeStat(t.timeToSelect,"s")&&e.StatObj.stat("selectionLatency",{inputMethod:t.inputMethod},{type:"duration",unit:"s",datum:t.timeToSelect}),e._isValidTimeStat(t.end2endTime,"s")&&e.StatObj.stat("inputToSelectionTime",{inputMethod:t.inputMethod},{type:"duration",unit:"s",datum:t.end2endTime})}},o._onPrefetchDataReceived=function(t){t&&n(t.limit)&&n(t.recipients)&&n(t.totalResults)&&this.StatObj.stat("prefetchResultInfo",{resLimit:t.limit,recipients:t.recipients,totalResults:t.totalResults})},o._onServerDataReceived=function(t){if(t){"boolean"==typeof t.doRender&&this.StatObj.stat("doRender",{status:t.doRender}),n(t.recipients)&&n(t.queryLength)&&n(t.totalResults)&&this.StatObj.stat("responseInfo",{recipients:t.recipients,queryLength:t.queryLength,totalResults:t.totalResults});var e=t.xTiming,o="string"==typeof e&&e.match(/pachinko: *(\d+)/);n(e=o&&o.length>1?parseInt(o[1],10):null)&&this.StatObj.stat("xTiming",{},{type:"duration",unit:"ms",datum:e})}},o._onCacheCheck=function(t){t&&"boolean"==typeof t.hit&&this.StatObj.stat("cache",{hit:t.hit})},o._onError=function(t){t&&"string"==typeof t.msg&&this.StatObj.stat("error",{status:t.msg.replace(/\s+/g,"_").substr(0,200)})},o._onSocialFooterClick=function(t){t&&t.provider&&(this.StatObj.stat("socialFooterClick",t),this.StatObj.stat(t.provider+"_footer_click",{reconnect:t.reconnect}))},o._onSocialHideClick=function(t){t&&t.provider&&this.StatObj.stat("socialFooterHide",t)},o._onSocialFooterShow=function(t){t&&t.provider&&(this.StatObj.stat("socialFooterShow",t),this.StatObj.stat(t.provider+"_footer_view",{reconnect:t.reconnect}))},o._onStaticFooterShow=function(){this.StatObj.stat("staticFooterShow")},o.onStaticFooterClick=function(){this.StatObj.stat("staticFooterClick")},o._onHideEndpoint=function(){this.StatObj.stat("hideEndpoint")},o._onUnhideEndpoint=function(){this.StatObj.stat("unhideEndpoint")},o._onHideRelatedContacts=function(t){this.StatObj.stat("hideRelatedContacts",{duration:t})},o._onRetriesFinished=function(t){t&&n(t.retries)&&this.StatObj.stat("retries",{totalRetries:t.retries})},o._onPerformanceRequest=function(t){if(t&&t.entry&&t.baseURL&&this._isValidTimeStat(t.entry.duration,"ms")){var e={};["startTime","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","duration"].forEach(function(n){e[n]=t.entry[n]}),e.queryLatency=t.queryLatency,e.xTiming=t.fullxTiming,e.baseURL=t.baseURL,yui.fire("SplunkLog","autosuggest_searchPerformance",e,"sample")}},o.detachListeners=function(){var t,e=this;for(t=0;t<e.statHandlers.length;t++)e.statHandlers[t].detach();e.statHandlers.length=0,e.StatObj=null},t.namespace("autosuggest.tictac").Stats=e},"0.0.1",{requires:["event-base"]});