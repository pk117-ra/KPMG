YUI.add("tictac-autosuggest",function(t){"use strict";function e(){return t.common.Utils.settings.value("appid")}function s(e,s){return t.Tictac.base.getAssetURL(e,"tictac-autosuggest",s)}function a(e){return t.Tictac.base&&t.Tictac.base.isRTL?e.replace(/\.css$/,"_bidi.css"):e}function i(t){f||(f=new t.Tictac.base.Stats({name:"autosuggest",yamas:!0}))}function o(){var e=t.Tictac.base.getTictacVersion("autosuggest").filter,a=window.NeoConfig?window.NeoConfig.lang:"en-US";t.Tictac.base.defineModuleGroup("autosuggest",{filter:e,modules:{"tictac-autosuggest-rollups":{path:s("js/tictac-autosuggest-rollups_"+a+"-min.js"),requires:["handlebars-base"]},"tictac-autosuggest-strings":{path:s("js/strings/lang_"+a+"-min.js")},"autosuggest-contact-api":{path:s("js/contactapi-min.js")},"autosuggest-highlight-helper":{path:s("js/autosuggesthighlighthelper-min.js")},"autosuggest-response-formatter":{path:s("js/autosuggestresponseformatter-min.js"),requires:["autosuggest-highlight-helper","handlebars-base"]},"autosuggest-api":{path:s("js/autosuggestapi-min.js"),requires:["autosuggest-response-formatter","io-base","querystring-stringify","event-base","querystring-parse","autosuggest-search-performance","autosuggest-api-mail-endpoints","autosuggest-api-state"]},"autosuggest-api-cache":{path:s("js/autosuggestapicache-min.js"),requires:["autosuggest-api","autosuggest-api-cache-object"]},"autosuggest-api-factory":{path:s("js/autosuggestapifactory-min.js"),requires:["autosuggest-api","autosuggest-api-cache"]},"autosuggest-social-footer":{path:s("js/socialfooter-min.js"),requires:["event","tictac-autosuggest-rollups","mail-common-utils-features"]},"autosuggest-compose-utils":{path:s("js/autosuggestcomposeutilities-min.js"),requires:["tictac-autosuggest-rollups"]},"tictac-autosuggest-compose":{path:s("js/autosuggesttictaccompose-min.js"),requires:["node","event","autosuggest-social-footer","autosuggest-main","autosuggest-api","comms-intl-bidi","handlebars-base","common-net-session","autosuggest-compose-utils","autosuggest-api-factory","autosuggest-prefetch-store","autosuggest-api-mail-endpoints"]},"autosuggest-footer-manager":{path:s("js/autosuggestfootermanager-min.js")},"autosuggest-static-footer-manager":{path:s("js/autosuggeststaticfootermanager-min.js")},"autosuggest-main":{path:s("js/autosuggestmain-min.js"),requires:["node","autocomplete","event","autosuggest-footer-manager","autosuggest-static-footer-manager","mail-common-utils-features","autosuggest-api","autosuggest-css","tictac-autosuggest-rollups"]},"autosuggest-api-mail-endpoints":{path:s("js/autosuggestapimailendpoints-min.js"),requires:["mail-common-utils-features"]},"autosuggest-standalone-loader":{path:s("js/standaloneloader-min.js"),requires:["autosuggest-api","autosuggest-main","autosuggest-standalone-helper","querystring-parse","autosuggest-api-factory"]},"autosuggest-standalone-helper":{path:s("js/autosuggeststandalonehelper-min.js"),requires:["autosuggest-compose-utils"]},"autosuggest-tictac-stats":{path:s("js/autosuggesttictacstats-min.js"),require:["event-base"]},"autosuggest-prefetch-store":{path:s("js/prefetchstore-min.js")}}},"min"===e)}function n(e,s){if(!p){var a=["contains","destructor","detach","fire","generateID","getItemMarkup","handleEscape","hide","isVisible","on","one","hasItemSelected","refresh","render","set","setAlign","setSize"],i={},o=null;t.Array.each(a,function(t){i[t]=!0}),s&&s.contacts&&s.contacts.ui&&s.contacts.ui.ACWidget&&s.contacts.ui.ACWidget.prototype&&(o=s.contacts.ui.ACWidget.prototype),e.ACWidgetInst&&e.ACWidgetInst.get("ac").destructor(),e.ACWidgetInst=p=s.autosuggest.tictac.shim.create(o,a,{canHandleEnter:function(){return!0},get:function(t){return"data"===t?"data":this},handleEnter:function(){}})}}function u(e){var s,a;for(i(e),n(t,e),t.log("Taking over autosuggest.","debug"),f.stat("info",{intl:NeoConfig.intl,internal:(!!NeoConfig.isInternal).toString()}),o(),l||(l=YUI()),c||l.use("autosuggest-tictac-stats",function(t){c=new t.autosuggest.tictac.Stats(t,f)}),yui.on("autosuggest:standalone:initialize",function(t){window.NeoConfig?r(t):d&&d.isXobnifiedAndAvailable&&t.id&&d.isXobnifiedAndAvailable(function(e){e&&r(t)})}),yui.on("autosuggest:standalone:destroy",function(e){e.id&&e.id in b&&(t.Array.each(b[e.id],function(t){t.detach(),t.destroy()}),delete b[e.id])}),v=y,s=j.length,a=0;a<s;a++)g(j[a]);j.length=0}function g(t){var s=t.context,a=s&&s.header,i=s&&s.draft&&s.draft.from&&s.draft.from.email;l.use("tictac-autosuggest-compose",function(s){if(t.rte.baseNode){var o=s.autosuggest.tictac.compose.create(),n={yBaseNode:t.rte.baseNode,shim:p,fromAccount:i||"",apiConfig:{xobniBaseURL:m,getAppid:e},showPerf:1===h.xShowPerf,useCache:1!==h.xDisableCache};o.init(n),a&&a.on("closeChange",function(t){1===t.newVal&&o.destroy()})}})}function r(t){l.use("autosuggest-standalone-loader",function(s){b[t.id]=s.Array.map(t.inputSelectors,function(a){return s.autosuggest.standalone.init(s.one(a),s.mix(t.config,{getAppid:e,xobniBaseURL:m}))})})}var c,l,p,f,d=t.xobniContacts,m=d&&d.Utils.getXobniBaseURL().url,h=t.QueryString.parse(window.location.search.substr(1)),b={},j=[],y="initialized",v="uninitialized";t.namespace("Tictac").autosuggest={loader:function(e){(e||"uninitialized"===v)&&("uninitialized"===v?(v="inprogress",e&&j.push(e),t.use("ac-widget","tictac-autosuggest-shim","isXobnifiedCheck","get","tictac-base-stats",function(t){var e=!1,o=function(){e&&u(t)};t.Get.css(a(s("css/autosuggest.css",!0)),function(s){if(s)return t.log("Error loading CSS: "+s[0].error),i(t),void f.stat("cssFailToLoad",{browser_info:NeoConfig.browser,error:s[0].error});e=!0,o()})})):"inprogress"===v?j.push(e):g(e))}}},"1.0.0",{requires:["tictac-base","querystring-parse","io-base","mail-common-utils-settings","xobni-utilities"]}),YUI.add("tictac-autosuggest-shim",function(t){"use strict";t.namespace("autosuggest.tictac").shim={create:function(e,s,a,i){function o(t,e){return t&&"string"==typeof t&&"__setHandler__"!==t&&"__unsetHandler__"!==t&&!p[t]&&e&&"function"==typeof e}var n,u,g,r,c={},l=a&&"object"==typeof a?a:{},p={};l.__setHandler__=function(t,e){return!!o(t,e)&&(c[t]||(c[t]=[]),c[t].push(e),!0)},l.__unsetHandler__=function(t,e){var s,a,i;if(o(t,e)&&(i=c[t]))for(s=0,a=i.length;s<a;++s)if(i[s]===e)return i.splice(s,1),!0;return!1},n=function(t,e){var s,a,o;if(i&&i(t),c[t]&&c[t].length){for(s=!1,a=0,o=c[t].length;a<o;++a)"function"==typeof c[t][a]&&(s=s||!!c[t][a]());return s}return e};for(u in l)p[u]=!0;for(g in e)l[g]||("function"==typeof(r=e[g])?l[g]=t.bind(n,this,g,l):"string"!=typeof r&&"number"!=typeof r&&"boolean"!=typeof r||(l[g]=e[l]));return t.Array.each(s,function(e){l[e]||(l[e]=t.bind(n,this,e,l))}),l}}},"1.0.0");